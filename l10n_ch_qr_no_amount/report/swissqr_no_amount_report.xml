<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <report id="l10n_ch_qr_no_amount_report"
        model="account.move"
        report_type="qweb-pdf"
        string="QR-No-Amount-bill"
        name="l10n_ch_qr_no_amount.qr_no_amount_report_main"
        file="l10n_ch_qr_no_amount.qr_report_main"
        attachment="'QR-bill-' + object.name + '.pdf'"
        menu="False"
        print_report_name="'QR-bill-%s' % object.name"
        paperformat="l10n_ch.paperformat_euro_no_margin"/>

    <template id="l10n_ch_swissqr_no_amount_template" inherit_id="l10n_ch.l10n_ch_swissqr_template" primary="True">

        <xpath expr="//t[@t-set='o']" position="attributes">
            <attribute name="t-value">o.with_context(**{'lang': lang, '_no_amount_qr_code': True})</attribute>
        </xpath>
        <!-- Remove any amount -->
        <xpath expr="//t[@t-set='formated_amount']" position="attributes">
            <attribute name="t-value">str()</attribute>
        </xpath>
    </template>

    <template id="l10n_ch_qr_no_amount.qr_no_amount_report_main">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-set="lang" t-value="o.partner_id.lang"/>
                <t t-call="l10n_ch_qr_no_amount.l10n_ch_swissqr_no_amount_template" t-lang="lang"/>
            </t>
        </t>
    </template>
</odoo>
